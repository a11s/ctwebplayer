# CTWebPlayer 多语言支持功能测试清单

## 测试概述
本文档提供了 CTWebPlayer 多语言支持功能的全面测试清单，包括所有需要测试的功能点、详细测试步骤和预期结果。

## 支持的语言
- English (en-US)
- 简体中文 (zh-CN)
- 繁體中文 (zh-TW)
- 日本語 (ja)
- 한국어 (ko)

## 测试场景

### 1. 首次启动应用（系统语言检测）

#### 1.1 系统语言为支持的语言
**测试步骤：**
1. 清除配置文件（删除或重命名 config.json）
2. 将系统语言设置为简体中文
3. 启动应用程序

**预期结果：**
- 应用应自动检测系统语言为简体中文
- 所有界面元素应显示为简体中文
- 日志应记录："检测到系统语言: zh-CN"

#### 1.2 系统语言为不支持的语言
**测试步骤：**
1. 清除配置文件
2. 将系统语言设置为法语（fr-FR）
3. 启动应用程序

**预期结果：**
- 应用应回退到英语（en-US）
- 所有界面元素应显示为英文
- 日志应记录："系统语言 fr-FR 不支持，回退到英语 (en-US)"

#### 1.3 系统语言为中性文化（如 "en"）
**测试步骤：**
1. 清除配置文件
2. 将系统语言设置为中性英语（en）
3. 启动应用程序

**预期结果：**
- 应用应将 "en" 映射到 "en-US"
- 界面显示为英文
- 日志应记录："检测到系统语言: en, 映射到: en-US"

### 2. 通过设置界面切换语言

#### 2.1 切换到不同语言
**测试步骤：**
1. 启动应用（当前语言为英语）
2. 打开设置窗口
3. 从语言下拉列表选择"简体中文"
4. 点击确定

**预期结果：**
- 设置窗口应立即更新为简体中文
- 主窗口和所有打开的窗口应更新为简体中文
- 配置文件应保存新的语言设置

#### 2.2 取消语言切换
**测试步骤：**
1. 打开设置窗口
2. 选择新语言但不点击确定
3. 点击取消

**预期结果：**
- 语言设置不应改变
- 界面保持原语言

### 3. 语言切换后UI更新

#### 3.1 主窗口更新
**测试步骤：**
1. 在主窗口打开的状态下切换语言

**需要检查的元素：**
- 窗口标题
- 菜单项（文件、编辑、查看、工具、帮助）
- 工具栏按钮文本
- 状态栏文本
- 所有按钮和标签

**预期结果：**
- 所有文本元素应立即更新为新语言
- 布局应保持正确，不出现文本截断

#### 3.2 对话框更新
**测试窗口列表：**
- 登录对话框 (LoginDialog)
- 设置窗口 (SettingsForm)
- 关于窗口 (AboutForm)
- 更新窗口 (UpdateForm)
- 日志查看器 (LogViewerForm)
- 代理设置窗口 (ProxySettingsForm)

**测试步骤：**
1. 打开每个对话框
2. 切换语言
3. 检查更新情况

**预期结果：**
- 所有已打开的对话框应立即更新
- 新打开的对话框应使用新语言

### 4. 重启应用后语言设置持久化

**测试步骤：**
1. 设置语言为日语
2. 关闭应用
3. 重新启动应用

**预期结果：**
- 应用应以日语启动
- 配置文件中应包含 "Language": "ja"
- 日志应记录："使用保存的语言设置: ja"

### 5. 格式化字符串测试

#### 5.1 包含占位符的字符串
**测试场景：**
- 版本信息显示（如："版本 {0}"）
- 错误消息（如："无法连接到服务器：{0}"）
- 进度信息（如："正在下载... {0}%"）

**测试步骤：**
1. 触发包含格式化字符串的场景
2. 检查每种语言的显示

**预期结果：**
- 占位符应正确替换为实际值
- 不同语言的语序应正确

### 6. 特殊控件本地化

#### 6.1 ListView 列标题
**测试步骤：**
1. 打开包含 ListView 的窗口（如日志查看器）
2. 切换语言
3. 检查列标题

**预期结果：**
- 所有列标题应更新为新语言

#### 6.2 DataGridView 列标题
**测试步骤：**
1. 打开包含 DataGridView 的窗口
2. 切换语言
3. 检查列标题

**预期结果：**
- 所有列标题应更新为新语言

### 7. 错误处理和回退机制

#### 7.1 资源文件缺失
**测试步骤：**
1. 临时重命名某个语言的资源文件
2. 尝试切换到该语言

**预期结果：**
- 应用不应崩溃
- 应回退到英语或显示资源键名

#### 7.2 资源键缺失
**测试步骤：**
1. 使用一个不存在的资源键
2. 观察显示结果

**预期结果：**
- 应显示资源键名作为后备
- 日志应记录警告："找不到资源键: [键名]"

### 8. 性能测试

**测试项目：**
1. 语言切换速度（应在1秒内完成）
2. 大量控件的窗口更新性能
3. 内存使用（切换语言不应导致内存泄漏）

### 9. 边界情况测试

#### 9.1 快速连续切换语言
**测试步骤：**
1. 快速切换语言多次

**预期结果：**
- 应用应保持稳定
- 最终显示的语言应与最后选择的一致

#### 9.2 配置文件损坏
**测试步骤：**
1. 手动编辑配置文件，设置无效的语言值
2. 启动应用

**预期结果：**
- 应用应使用系统语言检测
- 不应崩溃

### 10. 代码检查清单

#### 10.1 硬编码字符串检查
**检查位置：**
- [ ] Form1.cs - 主窗口
- [ ] LoginDialog.cs - 登录对话框
- [ ] SettingsForm.cs - 设置窗口
- [ ] AboutForm.cs - 关于窗口
- [ ] UpdateForm.cs - 更新窗口
- [ ] LogViewerForm.cs - 日志查看器
- [ ] ProxySettingsForm.cs - 代理设置
- [ ] 所有消息框和提示

#### 10.2 控件Tag属性检查
**需要检查：**
- 动态创建的控件是否设置了正确的Tag
- 特殊命名的控件是否能正确获取资源键

#### 10.3 资源文件完整性检查
**每个语言文件应包含：**
- 所有窗体标题
- 所有按钮文本
- 所有标签文本
- 所有菜单项
- 所有错误消息
- 所有提示信息

## 测试执行记录

| 测试项 | 测试人员 | 测试日期 | 结果 | 备注 |
|--------|----------|----------|------|------|
| 系统语言检测 | | | | |
| 语言切换功能 | | | | |
| UI更新完整性 | | | | |
| 持久化功能 | | | | |
| 格式化字符串 | | | | |
| 错误处理 | | | | |
| 性能测试 | | | | |

## 已知问题和限制

1. **右到左语言支持**：当前版本不支持阿拉伯语、希伯来语等RTL语言
2. **字体兼容性**：某些语言可能需要特定字体支持
3. **文本长度**：某些翻译可能比原文更长，需要调整控件大小

## 测试结论

测试完成后，请在此处总结：
- [ ] 所有测试用例通过
- [ ] 发现的问题已记录
- [ ] 性能符合预期
- [ ] 用户体验良好

---

最后更新：2025年9月14日