# 更新日志

所有显著的更改都将记录在此文件中。

本项目遵循 [语义化版本](https://semver.org/spec/v2.0.0.html) 规范。

## [1.2.1] - 2025-09-17

### 🔧 改进
- **窗口标题优化**
  - 窗口标题现在显示网页标题和玩家昵称
  - 格式：`网页标题 - 玩家昵称`（已登录）或 `网页标题 - （未登录）`（未登录）
  - 标题随页面导航和登录状态动态更新
  - 自动从 cookie 中读取玩家的 erolabsnickname
  - 支持 URL 编码的中文等特殊字符

### 🐛 修复
- **线程安全问题**
  - 修复退出登录时的线程错误（CoreWebView2 操作必须在 UI 线程执行）
  - 优化所有 Cookie 操作的线程安全性
  - 修复 DeleteAllCookies 引发的 InvalidOperationException

### 🚀 优化
- **代码质量改进**
  - 减少编译警告（从 52 个减少到 50 个）
  - 优化异步方法，移除不必要的 `await`
  - 使用 `Task.FromResult` 替代 `Task.CompletedTask`

## [1.2.0] - 2025-09-16

### ✨ 新功能
- **游戏截图功能**
  - 新增 F10 快捷键一键截取Unity游戏画面
  - 智能识别Unity WebGL canvas元素进行精准截图
  - 实现多种截图方案，解决WebGL渲染黑屏问题
  - 截图自动保存到程序目录下的 Capture 文件夹
  - 使用时间戳命名文件（Screenshot_yyyyMMdd_HHmmss.png）
  - 全屏模式下显示增强的截图成功提示（更大字体、脉冲动画）
  - 在实用工具菜单中添加"截图 (F10)"菜单项
  - 完整的多语言支持（支持所有5种语言）

### 🔧 改进
- **WebGL兼容性**
  - 自动为Unity canvas注入preserveDrawingBuffer设置
  - 增强的错误处理和黑屏检测机制
  - 添加详细的调试日志用于问题排查

## [1.1.0] - 2025-09-14

### ✨ 新功能
- **多语言支持**
  - 支持5种语言界面：英语、简体中文、繁体中文、日语、韩语
  - 首次启动时自动检测系统语言
  - 在设置界面提供语言切换功能
  - 语言设置持久化保存，重启后保持
  - 实时切换，所有已打开窗口立即更新
  - 完整的资源本地化系统

### 🔧 改进
- **界面优化**
  - 所有窗体控件添加了本地化支持
  - 菜单项、按钮、标签等UI元素完全本地化
  - 错误消息和提示信息支持多语言
  - 格式化字符串（带占位符）正确处理

### 🐛 修复
- 修正了部分硬编码的中文字符串
- 完善了异常消息的本地化处理

### 📝 文档
- 更新 README.md 添加多语言支持说明
- 创建了详细的多语言测试清单
- 编写了测试脚本用于验证功能
- 记录了发现的硬编码字符串问题

## [1.0.0] - 2025-09-14

### 🎉 首次发布

#### ✨ 新功能
- **智能缓存系统**
  - 自动缓存游戏静态资源（JS、CSS、图片、字体、Unity资源等）
  - 支持基于路径的缓存规则（/patch/files/）
  - 实时显示缓存命中率和缓存大小统计
  - 支持一键清理所有缓存
  
- **代理服务器支持**
  - 支持 HTTP/HTTPS 代理配置
  - 支持 SOCKS5 代理配置
  - 可随时启用或禁用代理
  
- **登录引导系统**
  - 智能检测登录状态（Cookie检测）
  - 友好的登录对话框
  - 支持跳过登录选项
  - 自动跳转游戏页面
  
- **窗口管理**
  - 可自定义窗口大小（默认 1236x840）
  - F11 全屏切换支持
  - 自动处理 Unity canvas 全屏显示
  - 窗口设置自动保存
  
- **音频控制**
  - F4 静音切换
  - 支持 Unity WebGL 音频控制
  - 静音状态实时显示
  
- **自动更新功能**
  - 检查 GitHub 最新版本
  - 显示更新内容和下载进度
  - 支持自动下载和安装
  
- **日志系统**
  - 多级别日志记录（Debug/Info/Warning/Error）
  - 日志文件自动轮转
  - 内置日志查看器
  - 调试模式下记录详细请求日志

#### 🛠️ 技术特性
- 基于 .NET 8.0 和 Windows Forms
- 使用 WebView2 作为浏览器引擎
- 自动处理 CORS 跨域问题
- 支持 iframe 自动导航
- 异步 I/O 操作优化性能

#### 📋 其他
- 完整的配置文件支持（config.json）
- BSD 3-Clause 许可证
- 详细的使用文档
- 第三方组件许可证声明

---

[1.2.1]: https://github.com/a11s/ctwebplayer/releases/tag/v1.2.1
[1.2.0]: https://github.com/a11s/ctwebplayer/releases/tag/v1.2.0
[1.1.0]: https://github.com/a11s/ctwebplayer/releases/tag/v1.1.0
[1.0.0]: https://github.com/a11s/ctwebplayer/releases/tag/v1.0.0
