!function(){var m,n,l,u,s,b,o={}.hasOwnProperty,r=[].slice;function y(t,e,n){this.command=t,this.headers=null!=e?e:{},this.body=null!=n?n:""}function t(t){this.ws=t,this.ws.binaryType="arraybuffer",this.counter=0,this.connected=!1,this.heartbeat={outgoing:1e4,incoming:1e4},this.maxWebSocketFrameSize=16384,this.subscriptions={}}m={LF:"\n",NULL:"\0"},y.prototype.toString=function(){var t,e,n=[this.command],i=this.headers;for(t in i)o.call(i,t)&&(e=i[t],n.push(t+":"+e));return this.body&&n.push("content-length:"+y.sizeOfUTF8(this.body)),n.push(m.LF+this.body),n.join(m.LF)},y.sizeOfUTF8=function(t){return t?encodeURI(t).split(/%..|./).length-1:0},s=function(t){for(var e,n,i,o,r,s,u,a,c=t.search(RegExp(""+m.LF+m.LF)),h=t.substring(0,c).split(m.LF),p=h.shift(),f={},d=function(t){return t.replace(/^\s+|\s+$/g,"")},l=h.reverse(),b=0,g=l.length;b<g;b++)o=(r=l[b]).indexOf(":"),f[d(r.substring(0,o))]=d(r.substring(o+1));if(e="",s=c+2,f["content-length"])h=parseInt(f["content-length"]),e=(""+t).substring(s,s+h);else for(i=u=s,a=t.length;(s<=a?u<a:a<u)&&(n=t.charAt(i))!==m.NULL;i=s<=a?++u:--u)e+=n;return new y(p,f,e)},y.unmarshall=function(t){for(var e,n=t.split(RegExp(""+m.NULL+m.LF+"*")),i=[],o=0,r=n.length;o<r;o++)0<(null!=(e=n[o])?e.length:void 0)&&i.push(s(e));return i},y.marshall=function(t,e,n){return new y(t,e,n).toString()+m.NULL},l=y,t.prototype.debug=function(t){return"undefined"!=typeof window&&null!==window?void window.console:void 0},b=function(){return Date.now||(new Date).valueOf},t.prototype._transmit=function(t,e,n){var i=l.marshall(t,e,n);for("function"==typeof this.debug&&this.debug(">>> "+i);;){if(!(i.length>this.maxWebSocketFrameSize))return this.ws.send(i);this.ws.send(i.substring(0,this.maxWebSocketFrameSize)),i=i.substring(this.maxWebSocketFrameSize),"function"==typeof this.debug&&this.debug("remaining = "+i.length)}},t.prototype._setupHeartbeat=function(o){var e,r,t,n,i,s;if((i=o.version)===u.VERSIONS.V1_1||i===u.VERSIONS.V1_2)return n=(i=(()=>{for(var t=o["heart-beat"].split(","),e=[],n=0,i=t.length;n<i;n++)r=t[n],e.push(parseInt(r));return e})())[0],i=i[1],0!==this.heartbeat.outgoing&&0!==i&&(e=Math.max(this.heartbeat.outgoing,i),"function"==typeof this.debug&&this.debug("send PING every "+e+"ms"),this.pinger=u.setInterval(e,(t=this,function(){return t.ws.send(m.LF),"function"==typeof t.debug?t.debug(">>> PING"):void 0}))),0!==this.heartbeat.incoming&&0!==n?(e=Math.max(this.heartbeat.incoming,n),"function"==typeof this.debug&&this.debug("check PONG every "+e+"ms"),this.ponger=u.setInterval(e,(s=this,function(){var t=b()-s.serverActivity;if(2*e<t)return"function"==typeof s.debug&&s.debug("did not receive server activity for the last "+t+"ms"),s.ws.close()}))):void 0},t.prototype._parseConnect=function(){var t,e,n=1<=arguments.length?r.call(arguments,0):[],i={};switch(n.length){case 2:i=n[0],t=n[1];break;case 3:n[1]instanceof Function?(i=n[0],t=n[1],e=n[2]):(i.login=n[0],i.passcode=n[1],t=n[2]);break;case 4:i.login=n[0],i.passcode=n[1],t=n[2],e=n[3];break;default:i.login=n[0],i.passcode=n[1],t=n[2],e=n[3],i.host=n[4]}return[i,t,e]},t.prototype.connect=function(){var f,d,e,t,n=1<=arguments.length?r.call(arguments,0):[],n=this._parseConnect.apply(this,n),i=n[0];return this.connectCallback=n[1],f=n[2],"function"==typeof this.debug&&this.debug("Opening Web Socket..."),this.ws.onmessage=(d=this,function(t){var i,o,e,n,r,s,u,a,c,h,p,t="undefined"!=typeof ArrayBuffer&&t.data instanceof ArrayBuffer?(i=new Uint8Array(t.data),"function"==typeof d.debug&&d.debug("--- got data length: "+i.length),(()=>{for(var t=[],e=0,n=i.length;e<n;e++)o=i[e],t.push(String.fromCharCode(o));return t})().join("")):t.data;if(d.serverActivity=b(),t!==m.LF){for("function"==typeof d.debug&&d.debug("<<< "+t),p=[],a=0,c=(h=l.unmarshall(t)).length;a<c;a++)switch((n=h[a]).command){case"CONNECTED":"function"==typeof d.debug&&d.debug("connected to server "+n.headers.server),d.connected=!0,d._setupHeartbeat(n.headers),p.push("function"==typeof d.connectCallback?d.connectCallback(n):void 0);break;case"MESSAGE":u=n.headers.subscription,(s=d.subscriptions[u]||d.onreceive)?(e=d,r=n.headers["message-id"],n.ack=function(t){return e.ack(r,u,t=null==t?{}:t)},n.nack=function(t){return e.nack(r,u,t=null==t?{}:t)},p.push(s(n))):p.push("function"==typeof d.debug?d.debug("Unhandled received MESSAGE: "+n):void 0);break;case"RECEIPT":p.push("function"==typeof d.onreceipt?d.onreceipt(n):void 0);break;case"ERROR":p.push("function"==typeof f?f(n):void 0);break;default:p.push("function"==typeof d.debug?d.debug("Unhandled frame: "+n):void 0)}return p}"function"==typeof d.debug&&d.debug("<<< PONG")}),this.ws.onclose=(e=this,function(){var t="Whoops! Lost connection to "+e.ws.url;return"function"==typeof e.debug&&e.debug(t),e._cleanUp(),"function"==typeof f?f(t):void 0}),this.ws.onopen=(t=this,function(){return"function"==typeof t.debug&&t.debug("Web Socket Opened..."),i["accept-version"]=u.VERSIONS.supportedVersions(),i["heart-beat"]=[t.heartbeat.outgoing,t.heartbeat.incoming].join(","),t._transmit("CONNECT",i)})},t.prototype.disconnect=function(t){return this._transmit("DISCONNECT"),this.ws.onclose=null,this.ws.close(),this._cleanUp(),"function"==typeof t?t():void 0},t.prototype._cleanUp=function(){if(this.connected=!1,this.pinger&&u.clearInterval(this.pinger),this.ponger)return u.clearInterval(this.ponger)},t.prototype.send=function(t,e,n){return null==n&&(n=""),(e=null==e?{}:e).destination=t,this._transmit("SEND",e,n)},t.prototype.subscribe=function(t,e,n){var i;return(n=null==n?{}:n).id||(n.id="sub-"+this.counter++),n.destination=t,this.subscriptions[n.id]=e,this._transmit("SUBSCRIBE",n),i=this,{id:n.id,unsubscribe:function(){return i.unsubscribe(n.id)}}},t.prototype.unsubscribe=function(t){return delete this.subscriptions[t],this._transmit("UNSUBSCRIBE",{id:t})},t.prototype.begin=function(t){var e,n=t||"tx-"+this.counter++;return this._transmit("BEGIN",{transaction:n}),e=this,{id:n,commit:function(){return e.commit(n)},abort:function(){return e.abort(n)}}},t.prototype.commit=function(t){return this._transmit("COMMIT",{transaction:t})},t.prototype.abort=function(t){return this._transmit("ABORT",{transaction:t})},t.prototype.ack=function(t,e,n){return(n=null==n?{}:n)["message-id"]=t,n.subscription=e,this._transmit("ACK",n)},t.prototype.nack=function(t,e,n){return(n=null==n?{}:n)["message-id"]=t,n.subscription=e,this._transmit("NACK",n)},n=t,u={VERSIONS:{V1_0:"1.0",V1_1:"1.1",V1_2:"1.2",supportedVersions:function(){return"1.1,1.0"}},client:function(t,e){return null==e&&(e=["v10.stomp","v11.stomp"]),t=new(u.WebSocketClass||WebSocket)(t,e),new n(t)},over:function(t){return new n(t)},Frame:l},"undefined"!=typeof window&&null!==window?(u.setInterval=function(t,e){return window.setInterval(e,t)},u.clearInterval=function(t){return window.clearInterval(t)},window.Stomp=u):"undefined"!=typeof exports&&null!==exports?exports.Stomp=u:self.Stomp=u}.call(this);