# Unity游戏截图功能测试方案

## 概述
本文档提供了ctwebplayer Unity游戏截图功能的详细测试步骤和验证方法。截图功能允许用户在游戏运行时通过F10热键快速截取游戏画面。

## 测试环境要求
- Windows 10 或更高版本
- 已安装 WebView2 Runtime
- ctwebplayer 已成功编译的可执行文件

## 一、启动程序和加载Unity游戏

### 1.1 启动程序
1. 运行 `ctwebplayer.exe`
2. 等待程序初始化完成，状态栏显示"浏览器初始化成功"

### 1.2 加载Unity游戏
1. 程序会自动导航到游戏页面
2. 如果启用了登录功能，按照提示完成登录流程
3. 等待Unity游戏完全加载
4. 确认看到游戏画面（Unity canvas元素）

## 二、截图功能测试步骤

### 2.1 窗口模式下截图测试
1. 确保程序在窗口模式下运行（非全屏）
2. 游戏加载完成后，按下 **F10** 键
3. 观察反馈：
   - 页面中央显示绿色提示框，显示"截图已保存：Screenshot_[时间戳].png"
   - 状态栏显示"截图已保存到：Screenshot_[时间戳].png"
4. 提示框会在2秒后自动消失

### 2.2 全屏模式下截图测试
1. 按下 **F11** 键进入全屏模式
2. 确认进入全屏（工具栏和状态栏隐藏）
3. 在全屏模式下按下 **F10** 键
4. 观察反馈：
   - 屏幕中央显示更大的绿色提示框（带动画效果）
   - 提示信息："截图已保存：Screenshot_[时间戳].png"
5. 提示框会在3秒后自动消失
6. 按 **F11** 退出全屏模式

### 2.3 查看保存的截图文件
1. 打开程序所在目录
2. 进入 `Capture` 文件夹（如果不存在会自动创建）
3. 查看截图文件：
   - 文件名格式：`Screenshot_yyyyMMdd_HHmmss.png`
   - 例如：`Screenshot_20250915_234520.png`
4. 打开截图文件验证内容是否正确

## 三、功能验证检查点

### 3.1 基本功能验证
- [x] F10热键能够正确触发截图功能
- [x] 截图文件成功保存到Capture目录
- [x] 文件名包含正确的时间戳
- [x] 截图内容为Unity游戏画面

### 3.2 UI反馈验证
- [x] 窗口模式下显示截图成功提示
- [x] 全屏模式下显示增强的提示效果
- [x] 状态栏正确显示截图信息
- [x] 提示框自动消失时间正确

### 3.3 多语言支持验证
- [x] 中文环境下提示信息正确
- [x] 切换语言后提示信息相应改变
- [x] 错误信息多语言显示正确

### 3.4 错误处理验证
- [x] Unity canvas未找到时显示友好错误提示
- [x] 截图失败时显示详细错误信息
- [x] 全屏模式下错误提示以页面内方式显示

## 四、可能遇到的问题和解决方案

### 问题1：按F10后没有反应
**可能原因：**
- 热键被其他程序占用
- WebView2未完全初始化

**解决方案：**
1. 关闭可能占用F10热键的其他程序
2. 等待游戏完全加载后再尝试
3. 查看日志文件确认热键是否成功注册

### 问题2：提示"Unity Canvas未找到"
**可能原因：**
- 游戏还未完全加载
- 当前页面不是游戏页面
- Unity canvas元素ID发生变化

**解决方案：**
1. 等待游戏完全加载（看到游戏画面）
2. 确保在游戏页面而非其他页面
3. 刷新页面重新加载游戏

### 问题3：截图文件无法找到
**可能原因：**
- Capture目录创建失败
- 文件保存权限问题

**解决方案：**
1. 确保程序有写入权限
2. 手动创建Capture目录
3. 以管理员权限运行程序

### 问题4：截图内容为空或黑屏
**可能原因：**
- Canvas内容保护策略
- WebGL渲染问题

**解决方案：**
1. 刷新页面重新加载游戏
2. 检查浏览器控制台是否有错误
3. 确保游戏正常渲染

## 五、测试日志和报告

### 5.1 查看日志文件
程序日志保存在 `logs` 目录下，包含：
- 热键注册信息
- 截图操作记录
- 错误信息详情

### 5.2 测试结果记录模板
```
测试日期：___________
测试版本：___________
测试人员：___________

测试项目 | 测试结果 | 备注
---------|----------|------
窗口模式截图 | ☐ 通过 ☐ 失败 | 
全屏模式截图 | ☐ 通过 ☐ 失败 | 
文件保存 | ☐ 通过 ☐ 失败 | 
UI提示显示 | ☐ 通过 ☐ 失败 | 
多语言支持 | ☐ 通过 ☐ 失败 | 
错误处理 | ☐ 通过 ☐ 失败 | 
```

## 六、性能和兼容性注意事项

1. **性能影响**：截图操作会短暂占用CPU，但不应影响游戏运行
2. **内存使用**：大尺寸截图会临时占用内存，完成后自动释放
3. **兼容性**：确保Unity游戏使用标准的canvas元素ID（unity-canvas）

## 七、高级测试场景

### 7.1 连续截图测试
快速连续按F10键，验证：
- 每次截图都能成功保存
- 文件名时间戳正确递增
- 不会出现文件覆盖

### 7.2 特殊状态测试
- 游戏加载中截图
- 游戏暂停时截图
- 切换场景时截图

### 7.3 边界条件测试
- 磁盘空间不足时的处理
- Capture目录被占用时的处理
- 超大分辨率游戏截图

## 八、总结

Unity游戏截图功能通过F10热键提供了便捷的游戏画面捕获能力，支持窗口和全屏两种模式，具有友好的用户反馈和完善的错误处理机制。测试时应重点关注功能的稳定性和用户体验的流畅性。